(()=>{"use strict";function e(e,t){const n=t.width/e.width,r=t.height/e.height;return({width:i,height:o,x:s,y:c})=>({width:i=Math.round(i*n),height:o=Math.round(o*r),x:s=Math.round(t.x+(s-e.x)*n),y:c=Math.round(t.y+(c-e.y)*r)})}function t(e,t){return e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height}const n=["cmd","ctrl","alt"],r=[...n,"shift"];var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function s(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function a(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function u(e){return"function"==typeof e}function l(e){var t=e(function(e){Error.call(e),e.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var h=l(function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}});function f(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var d=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,n,r,i;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var l=s(o),f=l.next();!f.done;f=l.next())f.value.remove(this)}catch(t){e={error:t}}finally{try{f&&!f.done&&(t=l.return)&&t.call(l)}finally{if(e)throw e.error}}else o.remove(this);var d=this.initialTeardown;if(u(d))try{d()}catch(e){i=e instanceof h?e.errors:[e]}var p=this._finalizers;if(p){this._finalizers=null;try{for(var y=s(p),w=y.next();!w.done;w=y.next()){var b=w.value;try{v(b)}catch(e){i=null!=i?i:[],e instanceof h?i=a(a([],c(i)),c(e.errors)):i.push(e)}}}catch(e){n={error:e}}finally{try{w&&!w.done&&(r=y.return)&&r.call(y)}finally{if(n)throw n.error}}}if(i)throw new h(i)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)v(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&f(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&f(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}(),p=d.EMPTY;function y(e){return e instanceof d||e&&"closed"in e&&u(e.remove)&&u(e.add)&&u(e.unsubscribe)}function v(e){u(e)?e():e.unsubscribe()}var w=null,b=null,m=void 0,g=!1,x=!1,_={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=_.delegate;return(null==i?void 0:i.setTimeout)?i.setTimeout.apply(i,a([e,t],c(n))):setTimeout.apply(void 0,a([e,t],c(n)))},clearTimeout:function(e){var t=_.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function S(){}var k=E("C",void 0,void 0);function E(e,t,n){return{kind:e,value:t,error:n}}var F=null;function M(e){if(g){var t=!F;if(t&&(F={errorThrown:!1,error:null}),e(),t){var n=F,r=n.errorThrown,i=n.error;if(F=null,r)throw i}}else e()}var O=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,y(t)&&t.add(n)):n.destination=I,n}return o(t,e),t.create=function(e,t,n){return new T(e,t,n)},t.prototype.next=function(e){this.isStopped?A(function(e){return E("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?A(E("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?A(k,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(d),W=Function.prototype.bind;function P(e,t){return W.call(e,t)}var C=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){j(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){j(e)}else j(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){j(e)}},e}(),T=function(e){function t(t,n,r){var i,o,s=e.call(this)||this;return u(t)||!t?i={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:s&&x?((o=Object.create(t)).unsubscribe=function(){return s.unsubscribe()},i={next:t.next&&P(t.next,o),error:t.error&&P(t.error,o),complete:t.complete&&P(t.complete,o)}):i=t,s.destination=new C(i),s}return o(t,e),t}(O);function j(e){var t;g?(t=e,g&&F&&(F.errorThrown=!0,F.error=t)):function(e){_.setTimeout(function(){if(!w)throw e;w(e)})}(e)}function A(e,t){var n=b;n&&_.setTimeout(function(){return n(e,t)})}var I={closed:!0,next:S,error:function(e){throw e},complete:S},z="function"==typeof Symbol&&Symbol.observable||"@@observable";function V(e){return e}var $=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r,i=this,o=(r=e)&&r instanceof O||function(e){return e&&u(e.next)&&u(e.error)&&u(e.complete)}(r)&&y(r)?e:new T(e,t,n);return M(function(){var e=i,t=e.operator,n=e.source;o.add(t?t.call(o,n):n?i._subscribe(o):i._trySubscribe(o))}),o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=K(t))(function(t,r){var i=new T({next:function(t){try{e(t)}catch(e){r(e),i.unsubscribe()}},error:r,complete:t});n.subscribe(i)})},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[z]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0===(n=e).length?V:1===n.length?n[0]:function(e){return n.reduce(function(e,t){return t(e)},e)})(this);var n},e.prototype.toPromise=function(e){var t=this;return new(e=K(e))(function(e,n){var r;t.subscribe(function(e){return r=e},function(e){return n(e)},function(){return e(r)})})},e.create=function(t){return new e(t)},e}();function K(e){var t;return null!==(t=null!=e?e:m)&&void 0!==t?t:Promise}var D=l(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),H=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return o(t,e),t.prototype.lift=function(e){var t=new U(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new D},t.prototype.next=function(e){var t=this;M(function(){var n,r;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var i=s(t.currentObservers),o=i.next();!o.done;o=i.next())o.value.next(e)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}})},t.prototype.error=function(e){var t=this;M(function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}})},t.prototype.complete=function(){var e=this;M(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,r=n.hasError,i=n.isStopped,o=n.observers;return r||i?p:(this.currentObservers=null,o.push(e),new d(function(){t.currentObservers=null,f(o,e)}))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t.thrownError,i=t.isStopped;n?e.error(r):i&&e.complete()},t.prototype.asObservable=function(){var e=new $;return e.source=this,e},t.create=function(e,t){return new U(e,t)},t}($),U=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return o(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:p},t}(H),B=function(e){function t(t,n){return e.call(this)||this}return o(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(d),L={setInterval:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=L.delegate;return(null==i?void 0:i.setInterval)?i.setInterval.apply(i,a([e,t],c(n))):setInterval.apply(void 0,a([e,t],c(n)))},clearInterval:function(e){var t=L.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},N=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return o(t,e),t.prototype.schedule=function(e,t){var n;if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r=this.id,i=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(i,r,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(i,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),L.setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&L.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n,r=!1;try{this.work(e)}catch(e){r=!0,n=e||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,n=this.scheduler,r=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,f(r,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(B),q={now:function(){return(q.delegate||Date).now()},delegate:void 0},Y=function(){function e(t,n){void 0===n&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},e.now=q.now,e}(),J=function(e){function t(t,n){void 0===n&&(n=Y.now);var r=e.call(this,t,n)||this;return r.actions=[],r._active=!1,r}return o(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(Y),X=new J(N);function G(e){return function(t){if(function(e){return u(null==e?void 0:e.lift)}(t))return t.lift(function(t){try{return e(t,this)}catch(e){this.error(e)}});throw new TypeError("Unable to lift unknown Observable type")}}function Q(e,t,n,r,i){return new R(e,t,n,r,i)}var R=function(e){function t(t,n,r,i,o,s){var c=e.call(this,t)||this;return c.onFinalize=o,c.shouldUnsubscribe=s,c._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,c._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,c._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,c}return o(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(O);const Z=Object.assign(function(...e){e=e.map(e=>ee(e)),Phoenix.log(...e),console.trace(...e)},{notify:(...e)=>{e=e.map(e=>ee(e)),Phoenix.log(...e);const t=e.join(" ");Phoenix.notify(t),console.trace(...e)},noTrace:(...e)=>{e=e.map(e=>ee(e)),Phoenix.log(...e),console.log(...e)}});function ee(e){if(e instanceof Error){let t="";if(e.stack){const n=e.stack.trim().split("\n");n[0]+=` (:${e.line}:${e.column})`,t=`\n${n.map(e=>"\t at "+e).join("\n")}`}return`\n${e.toString()}${t}`}switch(typeof e){case"object":return"\n"+JSON.stringify(e,null,2);case"function":return e.toString();default:return e}}var te,ne;function re(e,t){ie(e,t,2,2)}function ie(e,t,n,r){const{height:i,width:o,x:s,y:c}=e.frame(),a=t.visibleFrame();e.origin={x:a.x+(a.width/n-o/2),y:a.y+(a.height/r-i/2)},e.show()}!function(e){e[e.NorthWest=0]="NorthWest",e[e.NorthEast=1]="NorthEast",e[e.SouthWest=2]="SouthWest",e[e.SouthEast=3]="SouthEast"}(te||(te={})),function(e){e[e.Forward=0]="Forward",e[e.Backward=1]="Backward"}(ne||(ne={}));const oe=new Map;let se=new Modal;const ce=new H;var ae,ue,le,he,fe;function de(e,t){if(!t)return;const n=t.app(),r=n.windows().filter(e=>""!==e.title()&&!e.isMinimized());if(r.length<2)return;if(e===ne.Forward)i=t,oe.set(i.hash(),+new Date);else{if(e!==ne.Backward)throw new Error("Unknown Direction: "+e);!function(e){oe.delete(e.hash())}(t)}var i;const o=function(e,t){switch(e){case ne.Forward:return[...t].sort(ye);case ne.Backward:return[...t].reverse().sort(ve);default:throw new Error("Unknown Direction: "+e)}}(e,r);Z(o.map(e=>e.hash()+" - "+e.title()));const s=o[0];se.weight=18,se.text=s.title(),se.icon=n.icon(),re(se,s.screen()),s.focus(),ce.next()}function pe(e){return oe.get(e.hash())||0}function ye(e,t){const[n,r]=[pe(e),pe(t)];return n===r?0:n<r?-1:1}function ve(e,t){const[n,r]=[pe(e),pe(t)];return n===r?0:n>r?-1:1}ce.pipe((void 0===fe&&(fe=X),G(function(e,t){var n=null,r=null,i=null,o=function(){if(n){n.unsubscribe(),n=null;var e=r;r=null,t.next(e)}};function s(){var e=i+2e3,r=fe.now();if(r<e)return n=this.schedule(void 0,e-r),void t.add(n);o()}e.subscribe(Q(t,function(e){r=e,i=fe.now(),n||(n=fe.schedule(s,2e3),t.add(n))},function(){o(),t.complete()},void 0,function(){r=n=null}))})),(ae=()=>{se.close(),se=new Modal},he=u(ae)?{next:ae,error:ue,complete:le}:ae,he?G(function(e,t){var n;null===(n=he.subscribe)||void 0===n||n.call(he);var r=!0;e.subscribe(Q(t,function(e){var n;null===(n=he.next)||void 0===n||n.call(he,e),t.next(e)},function(){var e;r=!1,null===(e=he.complete)||void 0===e||e.call(he),t.complete()},function(e){var n;r=!1,null===(n=he.error)||void 0===n||n.call(he,e),t.error(e)},function(){var e,t;r&&(null===(e=he.unsubscribe)||void 0===e||e.call(he)),null===(t=he.finalize)||void 0===t||t.call(he)}))}):V)).subscribe();const we=new Map;function be(e,t,n){if(Array.isArray(e)){const r=e.map(e=>me(e,t,n));return()=>r.forEach(e=>e())}return me(e,t,n)}function me(e,t,n){const r=new Key(e,t,(r,i)=>{const o=n=>{Z.notify(`Key: ${e} + [${t}]:`,n)};try{const e=n(r,i);return e instanceof Promise?e.catch(o):e}catch(e){o(e)}}),i=ge(e,t);return we.set(i,r),()=>function(e){const t=we.get(e);t&&(t.disable(),we.delete(e))}(i)}function ge(e,t){return e+t.sort().join()}function xe(e,t){const n=ge(e,t);return we.get(n)}const _e=10,Se="\nYour coffee is done,\ngo get it!\n",ke="iTerm2",Ee=ke.replace(/[0-9]+$/,"");function Fe(e){const t=e.name();return t===ke||t===Ee}function Me(){App.launch(Ee,{focus:!0})}const Oe={normal:"§1234567890-=qwertyuiop[]asdfghjkl;'\\`zxcvbnm,./",shift:'±!@#$%^&*()_+QWERTYUIOP{}ASDFGHJKL:"|~ZXCVBNM<>?',alt:" ¡™£¢∞§¶•ªº–≠œ∑´®†¥¨ˆøπ“‘åß∂ƒ©˙∆˚¬…æ«  ≈ç√∫˜µ≤≥÷",altShift:"±⁄€‹›ﬁﬂ‡°·‚—±Œ„´‰ˇÁ¨ Ø∏”’  Î ˝ÓÔÒÚÆ» ¸˛Ç◊ı˜Â¯˘¿"},We=["delete","escape","return","space"];function Pe(e){return new Promise(t=>{setTimeout(()=>t(),e)})}const Ce=new Map;function Te(e,t){if("object"!=typeof e)return e===t;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n of Object.keys(e)){if("object"==typeof e[n]&&!Te(e[n],t[n]))return!1;if(e[n]!==t[n])return!1}return!0}function je(e,t){const n=e.setFrame(t);return n&&Ce.delete(e.hash()),n}Event.on("windowDidClose",e=>{Ce.delete(e.hash())});const Ae=new class{constructor(){this.scanned="",this.keyHandlers=[]}scan(e){this.doneCallback=e,this.updateCallback=t=>{t&&(this.disable(),e(t))},this.enable()}scanln(e,t=()=>{}){this.enable(),this.doneCallback=e,this.updateCallback=t}enable(){if(this.scanned="",this.keyHandlers.length=0,!this.keyHandlers.length){for(let e=0;e<Oe.normal.length;e++){const t=Oe.normal[e],n=Oe.altShift[e]||" ";this.keyHandlers.push(new Key(t,[],()=>this.handleKeyPress(t)),new Key(t,["shift"],()=>this.handleKeyPress(Oe.shift[e])),new Key(t,["alt"],()=>this.handleKeyPress(Oe.alt[e])),new Key(t,["alt","shift"],()=>this.handleKeyPress(n)))}for(const e of We)this.keyHandlers.push(new Key(e,[],()=>this.handleKeyPress(e)),new Key(e,["shift"],t=>this.handleKeyPress(e,t)))}this.keyHandlers.forEach(e=>e.enable())}disable(){for(const e of this.keyHandlers){e.disable();const t=xe(e.key,e.modifiers);t&&t.enable()}}handleKeyPress(e,t){if(!this.doneCallback||!this.updateCallback)throw new Error("Scanner callbacks are not set up properly");switch(e){case"delete":return this.scanned=this.scanned.slice(0,-1),this.updateCallback(this.scanned);case"escape":return this.disable(),this.doneCallback("");case"return":return t&&t.modifiers.includes("shift")?(this.scanned+="\n",this.updateCallback(this.scanned)):(this.disable(),this.doneCallback(this.scanned));case"space":return this.scanned+=" ",this.updateCallback(this.scanned);default:return this.scanned+=e,this.updateCallback(this.scanned)}}};let Ie;Phoenix.set({daemon:!0,openAtLogin:!0}),Event.on("screensDidChange",()=>{Z("Screens changed")});let ze,Ve=!1;const $e=(e,t)=>{t||(Ve=!Ve)};function Ke({modifiers:e},t){return Math.ceil(e.length/2)==t.length&&t.map(t=>e.includes(t)).every(e=>e)}function De(e,t){const n=Object.keys(e);return n.length===Object.keys(t).length&&n.every(n=>e[n]===t[n])}Event.on("mouseDidMove",e=>{let t;if(Ve&&Ke(e,n))t="move";else{if(!Ve||!Ke(e,r))return Ve=!1,void(ze=void 0);t="resize"}if(ze)ze.type!==t&&(ze={type:t,win:ze.win,wf:ze.win.frame(),sf:ze.sf,mp:{...e}});else{const n=Window.at(e);if(!n)return;ze={type:t,win:n,wf:n.frame(),sf:n.screen().flippedVisibleFrame(),mp:{...e}}}const i=ze.mp.x-e.x,o=ze.mp.y-e.y;if(0===i&&0===o)return;Z(ze.win.screen().flippedVisibleFrame());const s={...ze.wf};if("move"===t){if(0===e.y)return void ze.win.maximize();s.x-=i,s.y-=o;const t=15;Math.abs(ze.sf.x-s.x)<=t&&(s.x=ze.sf.x);const n=ze.sf.width-s.width;Math.abs(n-s.x)<=t&&(s.x=n),Math.abs(ze.sf.y-s.y)<=t&&(s.y=ze.sf.y);const r=ze.sf.y+ze.sf.height-s.height;Math.abs(r-s.y)<=t&&(s.y=r),ze.win.setTopLeft(s)}else s.x+=i,s.x<ze.sf.x&&(s.x=ze.sf.x),s.y+=o,s.y<ze.sf.y&&(s.y=ze.sf.y),s.width-=2*i,s.height-=2*o,ze.win.setFrame(s)}),be("a",n,$e),be("a",r,$e),be("tab",n,async()=>{const t=Window.focused();if(!t)return;const n=t.isFullScreen();n&&(t.setFullScreen(!1),await Pe(900));const r=t.screen(),i=r.next();r.isEqual(i)||(je(t,e(r.flippedVisibleFrame(),i.flippedVisibleFrame())(t.frame())),n&&(await Pe(900),t.setFullScreen(!0)),t.focus())}),be("tab",r,()=>{const e=Window.focused();if(!e)return;const t=e.screen(),n=t.next();var r,i;t.isEqual(n)||je(e,(r=t.flippedVisibleFrame(),i=n.flippedVisibleFrame(),({width:e,height:t,x:n,y:o})=>({width:e,height:t,x:n=i.x+n-r.x,y:o=i.y+o-r.y}))(e.frame()))}),be(["left","j"],n,()=>{const e=Window.focused();if(!e)return;const{width:t,height:n,x:r,y:i}=e.screen().flippedVisibleFrame(),o={width:Math.floor(t/2),height:n,x:r,y:i},s={width:Math.floor(t/3),height:n,x:r,y:i},c={width:Math.floor(t/4),height:n,x:r,y:i};let a=o;De(e.frame(),o)&&(a=s),De(e.frame(),s)&&(a=c),je(e,a)}),be(["right","l"],n,()=>{const e=Window.focused();if(!e)return;const{width:t,height:n,x:r,y:i}=e.screen().flippedVisibleFrame(),o={width:Math.floor(t/2),height:n,x:r+Math.ceil(t/2),y:i},s={width:Math.floor(t/3),height:n,x:r+Math.ceil(t/3*2),y:i},c={width:Math.floor(t/4),height:n,x:r+Math.ceil(t/4*3),y:i};let a=o;De(e.frame(),o)&&(a=s),De(e.frame(),s)&&(a=c),je(e,a)}),be(["up","i"],n,()=>{const e=Window.focused();if(!e)return;const{width:t,x:n}=e.frame();let{height:r,y:i}=e.screen().flippedVisibleFrame();r=Math.ceil(r/2),je(e,{height:r,width:t,x:n,y:i})}),be(["down","k"],n,()=>{const e=Window.focused();if(!e)return;const{width:t,x:n}=e.frame();let{height:r,y:i}=e.screen().flippedVisibleFrame();r/=2,[r,i]=[Math.ceil(r),i+Math.floor(r)],je(e,{height:r,width:t,x:n,y:i})}),be("return",n,()=>{const t=Window.focused();t&&function(t){(function(e){const t=Ce.get(e.hash());return!(!t||!t.maximized)&&(Z(e.frame(),t.maximized.window),Te(e.screen().flippedVisibleFrame(),t.maximized.screen)&&Te(e.frame(),t.maximized.window))})(t)?je(t,function(t){let n=Ce.get(t.hash());return n||(n={screen:t.screen().flippedVisibleFrame(),window:t.frame()}),e(n.screen,t.screen().flippedVisibleFrame())(n.window)}(t)):function(e){const t={screen:e.screen().flippedVisibleFrame(),window:e.frame()},n=e.maximize(),r=e.hash();Ce.set(r,{...t,maximized:{screen:e.screen().flippedVisibleFrame(),window:e.frame()}})}(t)}(t)}),be(["left","j"],r,()=>{const e=Window.focused();if(!e)return;const{width:t,height:n,y:r,x:i}=e.frame();let{x:o}=e.screen().flippedVisibleFrame();je(e,{width:t,height:n,y:r,x:Math.max(o,i-t)})}),be(["right","l"],r,()=>{const e=Window.focused();if(!e)return;const{width:t,height:n,y:r,x:i}=e.frame();let{width:o,x:s}=e.screen().flippedVisibleFrame();const c=s+o-t;je(e,{width:t,height:n,y:r,x:Math.min(c,i+t)})}),be(["up","i"],r,()=>{const e=Window.focused();if(!e)return;const{width:t,height:n,x:r,y:i}=e.frame();let{y:o}=e.screen().flippedVisibleFrame();je(e,{width:t,height:n,x:r,y:Math.max(o,i-n)})}),be(["down","k"],r,()=>{const e=Window.focused();if(!e)return;const{width:t,height:n,x:r,y:i}=e.frame();let{height:o,y:s}=e.screen().flippedVisibleFrame();const c=s+o-n;je(e,{width:t,height:n,x:r,y:Math.min(c,i+n)})}),be("return",r,()=>{const e=Window.focused();e&&e.setFullScreen(!e.isFullScreen())}),be("space",r,()=>{const e=Window.focused();if(!e)return;const{width:t,height:n}=e.frame(),{width:r,height:i,x:o,y:s}=e.screen().flippedVisibleFrame();je(e,{height:n,width:t,x:o+r/2-t/2,y:s+i/2-n/2})}),be("§",[],(e,t)=>{t||function(){const e=Window.focused(),t=e?e.app():void 0;t&&Fe(t)&&t.windows().length?t.hide():Me()}()}),be("§",["cmd"],(e,t)=>{t||function(){const e=Window.focused(),t=e?e.app():void 0;if(!t||!Fe(t))return Me();const n=t.windows();if(!n.length)return Me();n[n.length-1].focus()}()}),be("p",n,()=>{const e=Window.focused();if(!e)return;const t=e.app().name(),n=e.app().bundleIdentifier(),r=e.app().processIdentifier(),i=e.title(),o=e.frame(),s=[`Application: ${t}`,`Title: ${i}`,`Frame: X=${o.x}, Y=${o.y}`,`Size: H=${o.height}, W=${o.width}`,`Bundle ID: ${n}`,`PID: ${r}`].join("\n");Z("Window information:\n"+s),re(Modal.build({duration:10,icon:e.app().icon(),text:s,weight:16}),Screen.main())}),be(".",n,()=>{const e=Window.focused();e&&(Z(e.screen().windows({visible:!0}).map(e=>e.title())),Z(e.screen().windows().map(e=>e.title())))}),be("delete",n,()=>{const e=Window.focused();if(e){const t=e.screen().windows({visible:!0});if(Z(t.map(e=>e.title())),e.minimize(),t.length){const e=t[t.length>1?1:0];Z("focusing: "+e.title()),e.focus()}}}),be("m",n,()=>{const e=function(e){const n=Screen.all();for(const r of n)if(t(e,r.flippedFrame()))return r;throw new Error("point out of range")}(Mouse.location());Z(e.identifier(),Mouse.location())}),be("c",n,()=>{if(Ie)return Ie.stop(),void(Ie=null);Ie=function({screen:e,timeout:t}){const n={modal:new Modal,screen:e,timeout:t},r=function(e){return()=>{if(!e.modal)return;e.timeout--;const t=e.timeout?"~"+String(e.timeout):"<1";e.modal.text=`Coffee in ${t} min`;const n=function(e,t,n){const{width:r,height:i}=e.frame();let{width:o,height:s,x:c,y:a}=t.visibleFrame();return n===te.SouthEast?c=c+o-r:te.SouthWest,{x:c,y:a}}(e.modal,e.screen,te.SouthEast);e.modal.origin=function({x:e,y:t},n,r,i){const o=n.visibleFrame();return e<o.x+o.width/2?e+=r:e-=r,t<o.y+o.height/2?t+=i:t-=i,{x:e,y:t}}(n,e.screen,_e,_e),e.modal.show()}}(n),i=setInterval(r,6e4),o=setTimeout(function(e,t){return()=>{clearTimeout(t),e.modal&&e.modal.close(),e.modal=new Modal,e.modal.text=Se.trim(),re(e.modal,e.screen)}}(n,i),6e4*n.timeout);return r(),{stop(){clearTimeout(i),clearTimeout(o),n.modal&&n.modal.close(),n.modal=void 0}}}({screen:Screen.main(),timeout:8})}),be("escape",["cmd"],()=>{return e=Window.focused(),de(ne.Forward,e);var e}),be("escape",["cmd","shift"],()=>{return e=Window.focused(),de(ne.Backward,e);var e}),be("space",n,()=>{const e=new Modal,t="Search: ";e.text=t,re(e,Screen.main());const n=Window.focused(),r=Window.all({visible:!0});let i=[...r];const o=Screen.main();let s=!0;function c(e){s!==e&&(s=e,c(e));const t=e?i.pop():i.shift();if(t)return e?i.unshift(t):i.push(t),t}const a=t=>()=>{if(!i.length)return;const n=c(t);n&&(n.focus(),e.icon=n.app().icon(),re(e,o))},u=new Key("tab",[],a(!1)),l=new Key("tab",["shift"],a(!0));Ae.scanln(t=>{e.close(),u.disable(),l.disable(),""===t&&n&&(n.focus(),setTimeout(()=>n.focus(),200))},c=>{u.enable(),l.enable(),s=!0,i=r.filter(e=>function(e){return e.app().name().toLowerCase().match(c.toLowerCase())}(e)||function(e){return e.title().toLowerCase().match(c.toLowerCase())}(e)),e.text=t+c+(c?`\n${i.length} results`:""),c&&i.length?(i[0].focus(),e.icon=i[0].app().icon()):(n&&n.focus(),e.icon=void 0),re(e,o)})}),be("h",["cmd"],(e,t)=>{if(t){const e=Window.all({visible:!0}).map(e=>e.app());return void new Set(e).forEach(e=>e.hide())}const n=Window.focused();n&&n.app().hide()});const He=App.get("Phoenix")||App.get("Phoenix (Debug)");!function(e,t=1,n){const r=new Modal;r.text=e,r.duration=t,n&&(r.icon=n),function(e){ie(e,Screen.main(),2,1+1/3)}(r)}("Phoenix (re)loaded!",2,He&&He.icon())})();